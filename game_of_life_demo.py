import base64
myscript = """IyBHYW1lIG9mIGxpZmUgaW1wbGVtZW50ZWQgaW4gUHl0aG9uLgojIEFkYXB0ZWQgZnJvbSBTdGFuZm9yZCBDUzEwNkIgYXNzaWdubWVudC4KIyBSZWFkeVB5dGhvbiBTcDE5CgppbXBvcnQgb3MKaW1wb3J0IHJhbmRvbQoKZGVmIGNscygpOgogICAgJycnQ2xlYXJzIHRoZSB0ZXJtaW5hbCBzY3JlZW4uJycnCiAgICBvcy5zeXN0ZW0oJ2NscycgaWYgb3MubmFtZT09J250JyBlbHNlICdjbGVhcicpCgpkZWYgcHJpbnRfd2VsY29tZV9tZXNzYWdlKCk6CiAgICAnJydQcmludHMgd2VsY29tZSBtZXNzYWdlcyB0byBjb25zb2xlLicnJwogICAgcHJpbnQoIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0iKQogICAgcHJpbnQoIldlbGNvbWUgdG8gUmVhZHlQeXRob24gU3AxOSBHYW1lIG9mIExpZmUhIikKICAgIHByaW50KCJBZGFwdGVkIGZyb20gU3RhbmZvcmQgQ1MxMDZCLiBHYW1lIG9mIGxpZmUgaXMgIikKICAgIHByaW50KCJhIHNpbXVsYXRpb24gb2YgdGhlIGxpZmVjeWNsZSBvZiBhIGJhY3RlcmlhIGNvbG9ueS4iKQogICAgcHJpbnQoIkNlbGxzIChYKSBsaXZlIGFuZCBkaWUgYnkgdGhlIGZvbGxvd2luZyBydWxlczoiKQogICAgcHJpbnQoIi0gQSBjZWxsIHdpdGggMSBvciBmZXdlciBuZWlnaGJvcnMgZGllcy4iKQogICAgcHJpbnQoIi0gTG9jYXRpb25zIHdpdGggMiBuZWlnaGJvcnMgcmVtYWluIHN0YWJsZS4iKQogICAgcHJpbnQoIi0gTG9jYXRpb25zIHdpdGggMyBuZWlnaGJvcnMgd2lsbCBjcmVhdGUgbGlmZS4iKQogICAgcHJpbnQoIi0gQSBjZWxsIHdpdGggNCBvciBtb3JlIG5laWdoYm9ycyBkaWVzLlxuIikKCgpkZWYgcHJpbnRfd29ybGQod29ybGRUb1ByaW50KToKICAgICcnJ1ByaW50cyB0aGUgZm9ybWF0dGVkIGdhbWUgd29ybGQgcmVwcmVzZW50YXRpb25zLicnJwogICAgZm9yIGkgaW4gcmFuZ2UobGVuKHdvcmxkVG9QcmludCkpOgogICAgICAgIGZvciBqIGluIHJhbmdlKGxlbih3b3JsZFRvUHJpbnRbMF0pKToKICAgICAgICAgICAgcHJpbnQod29ybGRUb1ByaW50W2ldW2pdLCBlbmQ9IiIpCiAgICAgICAgcHJpbnQoKQoKZGVmIGdldF93b3JsZCgpOgogICAgJycnQXNrcyB0aGUgdXNlciBmb3IgaW5wdXQgYW5kIGFjY29yZGluZ2x5IHJldHVybnMgYSAyRCBsaXN0IHJlcHJlc2VudGluZyB0aGUgd29ybGQuJycnCiAgICB3aGlsZSBUcnVlOgogICAgICAgIGZpbGVOYW1lID0gaW5wdXQoIkdyaWQgaW5wdXQgZmlsZSBuYW1lPyAob3IgdHlwZSAncmFuZG9tJykgIikKICAgICAgICBpZiBmaWxlTmFtZSA9PSAicmFuZG9tIjoKICAgICAgICAgICAgcmV0dXJuIGNyZWF0ZV9yYW5kb21fd29ybGQoKQogICAgICAgIHRyeToKICAgICAgICAgICAgZmhhbmQgPSBvcGVuKCIuL3dvcmxkcy8iICsgZmlsZU5hbWUpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludCgiSW52YWxpZCBmaWxlIG5hbWUuIFRyeSBhZ2Fpbi4iKQogICAgICAgICAgICBjb250aW51ZQogICAgICAgIHJldHVybiBjcmVhdGVfd29ybGQoZmhhbmQpCgpkZWYgY3JlYXRlX3JhbmRvbV93b3JsZCgpOgogICAgbnVtX3Jvd3MgPSByYW5kb20ucmFuZGludCgxMCwgMzApICNoZWlnaHQgcmFuZ2UKICAgIG51bV9jb2x1bW5zID0gcmFuZG9tLnJhbmRpbnQoMzAsIDcwKSAjd2lkdGggcmFuZ2UKICAgIHdvcmxkID0gY3JlYXRlX2VtcHR5XzJEX2xpc3QobnVtX3Jvd3MsIG51bV9jb2x1bW5zKQogICAgY2hvaWNlcyA9IFsiLSIsICItIiwgIi0iLCAiWCJdICMyNSUgY2hhbmNlIGFsaXZlIGZvciBlYWNoIGdyaWQKICAgIGZvciBpIGluIHJhbmdlKG51bV9yb3dzKToKICAgICAgICBmb3IgaiBpbiByYW5nZShudW1fY29sdW1ucyk6CiAgICAgICAgICAgIHdvcmxkW2ldW2pdID0gcmFuZG9tLmNob2ljZShjaG9pY2VzKQogICAgcmV0dXJuIHdvcmxkCgoKZGVmIGNyZWF0ZV93b3JsZChmaGFuZCk6CiAgICBjdXJyX2xpbmUgPSAwCiAgICBmb3IgbGluZSBpbiBmaGFuZDoKICAgICAgICBjdXJyX2xpbmUgKz0gMQogICAgICAgIGlmKGN1cnJfbGluZSA9PSAxKToKICAgICAgICAgICAgbnVtX3Jvd3MgPSBpbnQobGluZSkKICAgICAgICBlbGlmKGN1cnJfbGluZSA9PSAyKToKICAgICAgICAgICAgbnVtX2NvbHVtbnMgPSBpbnQobGluZSkKICAgICAgICAgICAgd29ybGQgPSBjcmVhdGVfZW1wdHlfMkRfbGlzdChudW1fcm93cywgbnVtX2NvbHVtbnMpCiAgICAgICAgZWxpZihjdXJyX2xpbmUgPT0gbnVtX3Jvd3MgKyAzKToKICAgICAgICAgICAgYnJlYWsKICAgICAgICBlbHNlOgogICAgICAgICAgICBsaW5lID0gbGluZS5zdHJpcCgpCiAgICAgICAgICAgIGxpbmVfbGlzdCA9IGxpc3QobGluZSkKICAgICAgICAgICAgd29ybGRbY3Vycl9saW5lIC0gM10gPSBsaW5lX2xpc3QKICAgIHJldHVybiB3b3JsZAoKCmRlZiBjcmVhdGVfZW1wdHlfMkRfbGlzdChoZWlnaHQsIHdpZHRoKToKICAgIHJldHVybiBbWyIiIGZvciBjb2x1bW4gaW4gcmFuZ2Uod2lkdGgpXSBmb3IgbGluZSBpbiByYW5nZShoZWlnaHQpXQoKZGVmIGFza193cmFwKCk6CiAgICB3aGlsZSBUcnVlOgogICAgICAgIHdyYXAgPSBpbnB1dCgiU2hvdWxkIHRoZSBzaW11bGF0aW9uIHdyYXAgYXJvdW5kIHRoZSBncmlkICh5L24pPyAiKQogICAgICAgIGlmIHdyYXAgPT0gInkiOgogICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgIGVsaWYgd3JhcCA9PSAibiI6CiAgICAgICAgICAgIHJldHVybiBGYWxzZQoKCmRlZiBhc2tfZm9yX2NtZCgpOgogICAgd2hpbGUgVHJ1ZToKICAgICAgICBjbWQgPSBpbnB1dCgidClpY2ssIGEpbmltYXRlLCBvciBxKXVpdD8gIikKICAgICAgICBpZiBjbWQgPT0gJ3QnIG9yIGNtZCA9PSAnYScgb3IgY21kID09ICdxJzoKICAgICAgICAgICAgYnJlYWsKICAgICAgICBlbHNlOgogICAgICAgICAgICBwcmludCgiUGxlYXNlIGVudGVyICd0Jywgb3IgJ2EnLCBvciAncSciICkKICAgIHJldHVybiBjbWQKCmRlZiBhc2tfaG93X21hbnlfZnJhbWVzKCk6CiAgICB3aGlsZSBUcnVlOgogICAgICAgIGNtZCA9IGlucHV0KCJIb3cgbWFueSBmcmFtZXM/ICIpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBjbWQgPSBpbnQoY21kKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcHJpbnQoIlBsZWFzZSBlbnRlciBhbiBpbnRlZ2VyLiIpCiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgaWYgY21kIDwgMToKICAgICAgICAgICAgcHJpbnQoIlBsZWFzZSBlbnRlciBhIHBvc2l0aXZlIGludGVnZXIuIikKICAgICAgICAgICAgY29udGludWUKICAgICAgICByZXR1cm4gY21kCgoKZGVmIGNhbGN1bGF0ZV9uZXh0KHdvcmxkLCB3cmFwKToKICAgIG5ld1dvcmxkID0gY3JlYXRlX2VtcHR5XzJEX2xpc3QobGVuKHdvcmxkKSwgbGVuKHdvcmxkWzBdKSkKICAgIGZvciBpIGluIHJhbmdlKGxlbih3b3JsZCkpOgogICAgICAgIGZvciBqIGluIHJhbmdlKGxlbih3b3JsZFswXSkpOgogICAgICAgICAgICBuZWlnaGJvcnMgPSBjYWxjdWxhdGVfbnVtX25laWdoYm9ycyh3b3JsZCwgaSwgaiwgd3JhcCkKICAgICAgICAgICAgaWYgbmVpZ2hib3JzID09IDAgb3IgbmVpZ2hib3JzID09IDEgb3IgbmVpZ2hib3JzID4gMzoKICAgICAgICAgICAgICAgIG5ld1dvcmxkW2ldW2pdID0gJy0nCiAgICAgICAgICAgIGVsaWYgbmVpZ2hib3JzID09IDM6CiAgICAgICAgICAgICAgICBuZXdXb3JsZFtpXVtqXSA9ICdYJwogICAgICAgICAgICBlbGlmIG5laWdoYm9ycyA9PSAyOgogICAgICAgICAgICAgICAgbmV3V29ybGRbaV1bal0gPSB3b3JsZFtpXVtqXQogICAgcmV0dXJuIG5ld1dvcmxkCgoKCmRlZiBjYWxjdWxhdGVfbnVtX25laWdoYm9ycyh3b3JsZCwgaSwgaiwgd3JhcCk6CiAgICBzdW0gPSAwCiAgICBoZWlnaHQgPSBsZW4od29ybGQpCiAgICB3aWR0aCA9IGxlbih3b3JsZFswXSkKICAgIGZvciByb3cgaW4gcmFuZ2UoaSAtIDEsIGkgKyAyKToKICAgICAgICBmb3IgY29sdW1uIGluIHJhbmdlKGogLSAxLCBqICsgMik6CiAgICAgICAgICAgIGlmIHdyYXA6CiAgICAgICAgICAgICAgICByb3cgPSAocm93ICsgaGVpZ2h0KSAlIGhlaWdodCAjIG1vZHVsYXIgdHJpY2sgZm9yIHdyYXBwaW5nIGFyb3VuZCBncmlkcy4gLTEgPT4gaGVpZ2h0IC0gMTsgaGVpZ2h0ID0+IDAKICAgICAgICAgICAgICAgIGNvbHVtbiA9IChjb2x1bW4gKyB3aWR0aCkgJSB3aWR0aCAjIHNpbWlsYXIgdG8gYWJvdmUKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICNubyB3cmFwcGluZy4gaWdub3JlIG91dCBvZiByYW5nZSBpbmRpY2VzCiAgICAgICAgICAgICAgICBpZiByb3cgPj0gaGVpZ2h0IG9yIHJvdyA8IDAgb3IgY29sdW1uID49IHdpZHRoIG9yIGNvbHVtbiA8IDA6CiAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgaWYgd29ybGRbcm93XVtjb2x1bW5dID09ICJYIjoKICAgICAgICAgICAgICAgIHN1bSArPSAxCiAgICBpZiB3b3JsZFtpXVtqXSA9PSJYIjoKICAgICAgICBzdW0gLT0gMQogICAgcmV0dXJuIHN1bQoKIyBHYW1lIG9mIGxpZmUgaW1wbGVtZW50ZWQgaW4gUHl0aG9uLgojIEFkYXB0ZWQgZnJvbSBTdGFuZm9yZCBDUzEwNkIgYXNzaWdubWVudC4KIyBSZWFkeVB5dGhvbiBTcDE5CmZyb20gdGltZSBpbXBvcnQgc2xlZXAKCnByaW50X3dlbGNvbWVfbWVzc2FnZSgpCndvcmxkID0gZ2V0X3dvcmxkKCkKd3JhcCA9IGFza193cmFwKCkgI0Jvb2xlYW4KcHJpbnRfd29ybGQod29ybGQpCgp3aGlsZSBUcnVlOgogICAgY21kID0gYXNrX2Zvcl9jbWQoKSAjInQiLCAiYSIsIG9yICJxIgogICAgaWYgY21kID09ICJ0IjogIyB0aWNrIG9uY2UsIHByaW50aW5nIHRoZSByZXN1bHRpbmcgc3RhdGUgYWZ0ZXIgMSBzdGVwLgogICAgICAgIHdvcmxkID0gY2FsY3VsYXRlX25leHQod29ybGQsIHdyYXApCiAgICAgICAgcHJpbnRfd29ybGQod29ybGQpCiAgICBlbGlmIGNtZCA9PSAiYSI6ICMgYW5pbWF0ZQogICAgICAgIGZyYW1lcyA9IGFza19ob3dfbWFueV9mcmFtZXMoKQogICAgICAgIHdoaWxlIGZyYW1lcyA+IDA6CiAgICAgICAgICAgIGNscygpICAjY2xlYXJzIHRoZSBzY3JlZW4KICAgICAgICAgICAgd29ybGQgPSBjYWxjdWxhdGVfbmV4dCh3b3JsZCwgd3JhcCkKICAgICAgICAgICAgcHJpbnRfd29ybGQod29ybGQpCiAgICAgICAgICAgIHNsZWVwKC4xNSkKICAgICAgICAgICAgZnJhbWVzIC09IDEKICAgIGVsaWYgY21kID09ICJxIjogIyBxdWl0CiAgICAgICAgYnJlYWsKcHJpbnQoIkhhdmUgYSBuaWNlIGxpZmUuIikK"""
eval(compile(base64.b64decode(myscript),'<string>','exec'))
